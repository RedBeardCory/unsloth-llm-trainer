"""
This type stub file was generated by pyright.
"""

from abc import ABC, abstractmethod
from pathlib import Path
from typing import Optional, Union

logger = ...
class ExtractManager:
    def __init__(self, cache_dir: Optional[str] = ...) -> None:
        ...
    
    def extract(self, input_path: str, force_extract: bool = ...) -> str:
        ...
    


class BaseExtractor(ABC):
    @classmethod
    @abstractmethod
    def is_extractable(cls, path: Union[Path, str], **kwargs) -> bool:
        ...
    
    @staticmethod
    @abstractmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class MagicNumberBaseExtractor(BaseExtractor, ABC):
    magic_numbers: list[bytes] = ...
    @staticmethod
    def read_magic_number(path: Union[Path, str], magic_number_length: int): # -> bytes:
        ...
    
    @classmethod
    def is_extractable(cls, path: Union[Path, str], magic_number: bytes = ...) -> bool:
        ...
    


class TarExtractor(BaseExtractor):
    @classmethod
    def is_extractable(cls, path: Union[Path, str], **kwargs) -> bool:
        ...
    
    @staticmethod
    def safemembers(members, output_path): # -> Generator[Any, Any, None]:
        """
        Fix for CVE-2007-4559
        Desc:
            Directory traversal vulnerability in the (1) extract and (2) extractall functions in the tarfile
            module in Python allows user-assisted remote attackers to overwrite arbitrary files via a .. (dot dot)
            sequence in filenames in a TAR archive, a related issue to CVE-2001-1267.
        See: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4559
        From: https://stackoverflow.com/a/10077309
        """
        ...
    
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class GzipExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class ZipExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @classmethod
    def is_extractable(cls, path: Union[Path, str], magic_number: bytes = ...) -> bool:
        ...
    
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class XzExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class RarExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class ZstdExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class Bzip2Extractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class SevenZipExtractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class Lz4Extractor(MagicNumberBaseExtractor):
    magic_numbers = ...
    @staticmethod
    def extract(input_path: Union[Path, str], output_path: Union[Path, str]) -> None:
        ...
    


class Extractor:
    extractors: dict[str, type[BaseExtractor]] = ...
    @classmethod
    def is_extractable(cls, path: Union[Path, str], return_extractor: bool = ...) -> bool:
        ...
    
    @classmethod
    def infer_extractor_format(cls, path: Union[Path, str]) -> Optional[str]:
        ...
    
    @classmethod
    def extract(cls, input_path: Union[Path, str], output_path: Union[Path, str], extractor_format: str) -> None:
        ...
    


